# AMP Email Generation API - Production Environment Configuration

# ============================================================================
# API Configuration
# ============================================================================
NODE_ENV=production
PORT=3000
API_VERSION=v1

# ============================================================================
# Database Configuration
# ============================================================================
DATABASE_URL=postgresql://username:password@postgres-service:5432/amp_email_db

# Connection pooling
DATABASE_POOL_MIN=10
DATABASE_POOL_MAX=50
DATABASE_POOL_TIMEOUT=30000

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_HOST=redis-service
REDIS_PORT=6379
REDIS_PASSWORD=your_secure_redis_password_here
REDIS_DB=0
REDIS_TLS_ENABLED=false

# Connection pooling
REDIS_POOL_MIN=5
REDIS_POOL_MAX=20

# ============================================================================
# Authentication & Security
# ============================================================================
JWT_SECRET=your_super_secret_jwt_key_min_32_characters_long_here
JWT_EXPIRATION=24h
JWT_REFRESH_EXPIRATION=7d

# API Key Configuration
API_KEY_PREFIX=amp_key_
API_KEY_LENGTH=32

# Encryption
ENCRYPTION_KEY=your_aes_256_encryption_key_32_bytes_here
ENCRYPTION_ALGORITHM=aes-256-gcm

# ============================================================================
# External Service APIs
# ============================================================================

# Replicate AI API
REPLICATE_API_KEY=r8_your_replicate_api_key_here
REPLICATE_MODEL=meta/llama-2-70b-chat:latest

# Product Scraper Microservice
SCRAPER_BASE_URL=https://product-scraper-217130114839.us-east1.run.app
SCRAPER_TIMEOUT=65000
SCRAPER_RETRY_ATTEMPTS=3

# ============================================================================
# GCP Configuration (for Cloud Run deployment)
# ============================================================================
GCP_PROJECT_ID=your-gcp-project-id

# ============================================================================
# Storage Configuration (Cloudflare R2)
# ============================================================================
R2_ACCOUNT_ID=your_cloudflare_account_id
R2_ACCESS_KEY_ID=your_r2_access_key_id
R2_SECRET_ACCESS_KEY=your_r2_secret_access_key
R2_BUCKET_NAME=amp-email-templates-production
R2_ENDPOINT=https://your_account_id.r2.cloudflarestorage.com

# R2 Public URL (use custom domain or R2.dev subdomain)
R2_PUBLIC_URL=https://cdn.amp-platform.com
CDN_BASE_URL=https://cdn.amp-platform.com

# ============================================================================
# Rate Limiting
# ============================================================================
RATE_LIMIT_ENABLED=true

# Rate limits per plan tier (requests per period)
RATE_LIMIT_FREE_MINUTE=10
RATE_LIMIT_FREE_HOUR=100
RATE_LIMIT_FREE_DAY=1000

RATE_LIMIT_STARTER_MINUTE=60
RATE_LIMIT_STARTER_HOUR=1000
RATE_LIMIT_STARTER_DAY=10000

RATE_LIMIT_GROWTH_MINUTE=300
RATE_LIMIT_GROWTH_HOUR=5000
RATE_LIMIT_GROWTH_DAY=50000

# Enterprise has unlimited rate limits

# ============================================================================
# Background Jobs & Queue
# ============================================================================
WORKER_CONCURRENCY=5
WORKER_POOL_SIZE=10

# Bull Queue Configuration
BULL_QUEUE_PREFIX=amp-email
BULL_REDIS_HOST=redis-service
BULL_REDIS_PORT=6379
BULL_REDIS_PASSWORD=your_secure_redis_password_here

# Job retry configuration
JOB_MAX_ATTEMPTS=3
JOB_BACKOFF_TYPE=exponential
JOB_BACKOFF_DELAY=2000

# ============================================================================
# Monitoring & Logging
# ============================================================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_TIMESTAMP=true

# Sentry Error Tracking
SENTRY_DSN=https://your_sentry_dsn@sentry.io/project_id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# APM Configuration
APM_ENABLED=true
APM_SERVICE_NAME=amp-email-api
APM_SERVER_URL=http://apm-server:8200
APM_SECRET_TOKEN=your_apm_secret_token

# ============================================================================
# Alert Configuration
# ============================================================================
# Slack Webhooks
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#amp-platform-alerts
SLACK_USERNAME=AMP Email Bot

# PagerDuty
PAGERDUTY_INTEGRATION_KEY=your_pagerduty_integration_key
PAGERDUTY_SEVERITY_THRESHOLD=error

# ============================================================================
# Email Service Providers (for integration examples)
# ============================================================================
# SendGrid
SENDGRID_API_KEY=SG.your_sendgrid_api_key_here

# Resend
RESEND_API_KEY=re_your_resend_api_key_here

# Note: For sending emails, you can use SendGrid or Resend (configured above)
# Or integrate with Cloud Functions for email delivery

# ============================================================================
# Webhook Configuration
# ============================================================================
WEBHOOK_TIMEOUT=10000
WEBHOOK_MAX_RETRIES=3
WEBHOOK_RETRY_DELAY=2000
WEBHOOK_SIGNATURE_ALGORITHM=sha256

# ============================================================================
# Template Generation Configuration
# ============================================================================
TEMPLATE_DEFAULT_VARIATIONS=3
TEMPLATE_MAX_VARIATIONS=5
TEMPLATE_PRESERVE_MERGE_TAGS=true
TEMPLATE_CACHE_TTL=3600

# ============================================================================
# Caching Configuration
# ============================================================================
CACHE_ENABLED=true
CACHE_DEFAULT_TTL=3600
CACHE_PRODUCT_TTL=86400
CACHE_TEMPLATE_TTL=7200

# ============================================================================
# Cost Tracking
# ============================================================================
COST_AI_GENERATION=0.0024
COST_PRODUCT_SCRAPING=0.0003
COST_CDN_DELIVERY=0.0010
COST_INFRASTRUCTURE=0.0001

# ============================================================================
# CORS Configuration
# ============================================================================
CORS_ENABLED=true
CORS_ORIGIN=https://app.amp-platform.com,https://dashboard.amp-platform.com
CORS_CREDENTIALS=true

# ============================================================================
# Health Check Configuration
# ============================================================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000

# ============================================================================
# Performance Limits
# ============================================================================
REQUEST_BODY_LIMIT=10mb
REQUEST_TIMEOUT=30000
MAX_CONCURRENT_REQUESTS=100

# Batch processing limits
BATCH_MAX_PRODUCTS=10000
BATCH_DEFAULT_CHUNK_SIZE=100
BATCH_MAX_CONCURRENT=50

# ============================================================================
# Feature Flags
# ============================================================================
FEATURE_AI_GENERATION=true
FEATURE_CDN_UPLOAD=true
FEATURE_WEBHOOK_NOTIFICATIONS=true
FEATURE_BATCH_PROCESSING=true
FEATURE_ANALYTICS=true
FEATURE_PERSONALIZATION=true

# ============================================================================
# Multi-Region Configuration
# ============================================================================
REGION=us-east-1
PRIMARY_REGION=us-east-1
SECONDARY_REGIONS=eu-west-1,ap-southeast-1

# Database replication
DB_READ_REPLICAS=postgres-replica-1:5432,postgres-replica-2:5432

# ============================================================================
# Backup Configuration
# ============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_GCS_BUCKET=amp-email-backups

# ============================================================================
# Security Headers
# ============================================================================
HELMET_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true
FRAME_GUARD_ENABLED=true

# ============================================================================
# Debug & Development
# ============================================================================
DEBUG_MODE=false
VERBOSE_LOGGING=false
STACK_TRACE_ENABLED=false

# ============================================================================
# API Documentation
# ============================================================================
SWAGGER_ENABLED=true
SWAGGER_PATH=/api/docs
API_DOCS_URL=https://docs.amp-platform.com
