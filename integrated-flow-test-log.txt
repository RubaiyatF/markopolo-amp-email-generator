ğŸš€ Starting Integrated Flow Tests

============================================================
Product: Gymshark Element Baselayer
Campaign: Product Launch
============================================================

TEST 1: Quick Flow (Template Only)
============================================================
ğŸ§ª Testing Quick Flow (without image generation)


ğŸš€ Starting Integrated Template Generation
============================================================
Product URL: https://uk.gymshark.com/products/gymshark-element-baselayer-mock-neck-long-sleeve-t-shirt-ls-tops-1
Campaign: product_launch
Generate Images: No
============================================================

ğŸ“¦ STEP 1: Scraping Product Data
------------------------------------------------------------
âœ… Redis connected successfully
âœ… Cache hit for product: https://uk.gymshark.com/products/gymshark-element-baselayer-mock-neck-long-sleeve-t-shirt-ls-tops-1
âœ… Product scraped in 296ms
   Name: Gymshark Element Baselayer Mock Neck Long Sleeve T-Shirt
   Price: GBP 36
   Brand: Uk
   Screenshot: Available

ğŸ¨ STEP 2: Generating Email Template
------------------------------------------------------------
âœ… Gemini Template Generator initialized
   Model: google/gemini-2.5-flash
ğŸ§  Generating template with Gemini (variation 0)...
ğŸ“š Fetching similar template from RAG...
ğŸ” Searching for templates matching campaign: product_launch
âœ… Qdrant client initialized
   URL: https://87c4bedb-f2e4-4439-aadd-8387cf5643fc.us-east4-0.gcp.cloud.qdrant.io:6333
   Collection: flodesk_templates
[Qdrant] isAvailable check: configured=true, hasClient=true
âœ… OpenAI client initialized for embeddings
   Model: text-embedding-3-small
ğŸ” Found 1 similar templates
âœ… Found 1 similar templates
   âœ“ Found template: 003_announcement.png (score: 61.9%)
âœ… Template generated successfully
   HTML Length: 4159 characters
   Image Placeholders: 1
   Processing Time: 7186ms
âœ… Template generated in 7186ms
   HTML Length: 4159 characters
   Image Placeholders: 1
   RAG Template: 003_announcement.png

â„¹ï¸  STEP 3: Skipped (generateImages = false)

============================================================
âœ… GENERATION COMPLETE!
============================================================
Total Time: 7482ms
   Scraping: 296ms
   Template: 7186ms
============================================================


âœ… Quick generation successful!
   Template: 4159 characters
   Placeholders: 1
   Time: 7482ms


TEST 2: Full Flow (Template + Images)
============================================================
ğŸ§ª Testing Integrated Template Generation Flow

Testing FULL flow (with AI image generation)...


ğŸš€ Starting Integrated Template Generation
============================================================
Product URL: https://uk.gymshark.com/products/gymshark-element-baselayer-mock-neck-long-sleeve-t-shirt-ls-tops-1
Campaign: product_launch
Generate Images: Yes
============================================================

ğŸ“¦ STEP 1: Scraping Product Data
------------------------------------------------------------
âœ… Cache hit for product: https://uk.gymshark.com/products/gymshark-element-baselayer-mock-neck-long-sleeve-t-shirt-ls-tops-1
âœ… Product scraped in 86ms
   Name: Gymshark Element Baselayer Mock Neck Long Sleeve T-Shirt
   Price: GBP 36
   Brand: Uk
   Screenshot: Available

ğŸ¨ STEP 2: Generating Email Template
------------------------------------------------------------
ğŸ§  Generating template with Gemini (variation 0)...
ğŸ“š Fetching similar template from RAG...
ğŸ” Searching for templates matching campaign: product_launch
[Qdrant] isAvailable check: configured=true, hasClient=true
ğŸ” Found 1 similar templates
âœ… Found 1 similar templates
   âœ“ Found template: 003_announcement.png (score: 61.9%)
âœ… Template generated successfully
   HTML Length: 3727 characters
   Image Placeholders: 1
   Processing Time: 7963ms
âœ… Template generated in 7963ms
   HTML Length: 3727 characters
   Image Placeholders: 1
   RAG Template: 003_announcement.png

ğŸ–¼ï¸  STEP 3: Generating Product Images
------------------------------------------------------------
âœ… Gemini Image Generator initialized
   Model: google/gemini-2.5-flash-image
ğŸ¨ Generating 1 product images...
   Product: Gymshark Element Baselayer Mock Neck Long Sleeve T-Shirt
   Style: product shot
   Generating image 1/1...
   âœ“ Image 1 generated
âœ… Generated 1/1 images
âœ… Images generated in 11847ms
   Generated: 1 images

ğŸ”„ STEP 4: Replacing Image Placeholders
------------------------------------------------------------
âœ… Placeholders replaced

============================================================
âœ… GENERATION COMPLETE!
============================================================
Total Time: 19897ms
   Scraping: 86ms
   Template: 7963ms
   Images: 11847ms
============================================================

ğŸ’¾ Saving Results
------------------------------------------------------------
âœ“ Product data: integrated-product-data.json
âœ“ Template: integrated-template.html (3727 chars)
âœ“ Template with images: integrated-template-with-images.html (3725 chars)
âœ“ Generated images: integrated-generated-images.json (1 images)
âœ“ Metadata: integrated-metadata.json

============================================================
âœ… TEST SUCCESSFUL!
============================================================
Summary:
  Product: Gymshark Element Baselayer Mock Neck Long Sleeve T-Shirt
  Brand: Uk
  Price: GBP 36
  RAG Template: 003_announcement.png
  Image Placeholders: 1
  Generated Images: 1
  Total Time: 19897ms
============================================================
âŒ Redis connection error: Error: read ECONNRESET
    at TCP.onStreamRead (node:internal/stream_base_commons:216:20) {
  errno: -4077,
  code: 'ECONNRESET',
  syscall: 'read'
}
âœ… Redis connected successfully
âŒ Redis connection error: Error: read ECONNRESET
    at TCP.onStreamRead (node:internal/stream_base_commons:216:20) {
  errno: -4077,
  code: 'ECONNRESET',
  syscall: 'read'
}
âœ… Redis connected successfully
